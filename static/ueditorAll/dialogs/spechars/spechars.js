/**
 * Created with JetBrains PhpStorm.
 * User: xuheng
 * Date: 12-9-26
 * Time: 下午1:09
 * To change this template use File | Settings | File Templates.
 */
var charsContent = [
    { name: "tsfh", title: "希腊字母", content: toArray("<div texCode='\\alpha ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:0px -30px;'></div>,<div texCode='\\beta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-18px -30px;'></div>,<div texCode='\\gamma ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-36px -30px;'></div>,<div texCode='\\delta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-54px -30px;'></div>,<div texCode='\\epsilon ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-72px -30px;'></div>,<div texCode='\\varepsilon ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-90px -30px;'></div>,<div texCode='\\zeta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-108px -30px;'></div>,<div texCode='\\eta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-126px -30px;'></div>,<div texCode='\\theta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-144px -30px;'></div>,<div texCode='\\vartheta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-162px -30px;'></div>,<div texCode='\\iota ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-180px -30px;'></div>,<div texCode='\\kappa ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-198px -30px;'></div>,<div texCode='\\lambda ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-216px -30px;'></div>,<div texCode='\\mu ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-234px -30px;'></div>,<div texCode='\\nu ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-252px -30px;'></div>,<div texCode='\\xi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-270px -30px;'></div>,<div texCode='\\pi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-288px -30px;'></div>,<div texCode='\\varpi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-306px -30px;'></div>,<div texCode='\\rho ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-324px -30px;'></div>,<div texCode='\\varrho ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-342px -30px;'></div>,<div texCode='\\sigma ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-360px -30px;'></div>,<div texCode='\\varsigma ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-378px -30px;'></div>,<div texCode='\\tau ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-396px -30px;'></div>,<div texCode='\\upsilon ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-414px -30px;'></div>,<div texCode='\\phi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-432px -30px;'></div>,<div texCode='\\varphi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-450px -30px;'></div>,<div texCode='\\chi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-468px -30px;'></div>,<div texCode='\\psi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-486px -30px;'></div>,<div texCode='\\omega ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-504px -30px;'></div>,<div texCode='\\Gamma ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-522px -30px;'></div>,<div texCode='\\Delta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-540px -30px;'></div>,<div texCode='\\Theta ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-558px -30px;'></div>,<div texCode='\\Lambda ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-576px -30px;'></div>,<div texCode='\\Xi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-594px -30px;'></div>,<div texCode='\\Pi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-612px -30px;'></div>,<div texCode='\\Sigma ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-630px -30px;'></div>,<div texCode='\\Upsilon ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-648px -30px;'></div>,<div texCode='\\Phi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-666px -30px;'></div>,<div texCode='\\Psi ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-684px -30px;'></div>,<div texCode='\\Omega ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-702px -30px;'></div>") },
    { name: "lmsz", title: "数学公式", content: toArray("<div texCode='\\times ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:0px -50px;'></div>,<div texCode='\\div ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-18px -50px;'></div>,<div texCode='\\cdot ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-36px -50px;'></div>,<div texCode='\\pm ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-54px -50px;'></div>,<div texCode='\\mp ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-72px -50px;'></div>,<div texCode='\\ast ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-90px -50px;'></div>,<div texCode='\\star ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-108px -50px;'></div>,<div texCode='\\circ ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-126px -50px;'></div>,<div texCode='\\bullet ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-144px -50px;'></div>,<div texCode='\\oplus ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-162px -50px;'></div>,<div texCode='\\ominus ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-180px -50px;'></div>,<div texCode='\\oslash ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-198px -50px;'></div>,<div texCode='\\otimes ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-216px -50px;'></div>,<div texCode='\\odot ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-234px -50px;'></div>,<div texCode='\\dagger ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-252px -50px;'></div>,<div texCode='\\ddagger ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-270px -50px;'></div>,<div texCode='\\vee ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-288px -50px;'></div>,<div texCode='\\wedge ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-306px -50px;'></div>,<div texCode='\\cap ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-324px -50px;'></div>,<div texCode='\\cup ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-342px -50px;'></div>,<div texCode='\\aleph ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-360px -50px;'></div>,<div texCode='\\Re ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-378px -50px;'></div>,<div texCode='\\Im ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-396px -50px;'></div>,<div texCode='\\top ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-414px -50px;'></div>,<div texCode='\\bot ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-432px -50px;'></div>,<div texCode='\\infty ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-450px -50px;'></div>,<div texCode='\\partial ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-468px -50px;'></div>,<div texCode='\\forall ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-486px -50px;'></div>,<div texCode='\\exists ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-504px -50px;'></div>,<div texCode='\\neg ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-522px -50px;'></div>,<div texCode='\\angle ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-540px -50px;'></div>,<div texCode='\\triangle ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-558px -50px;'></div>,<div texCode='\\diamond ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-576px -50px;'></div>,<div texCode='\\leq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:0px -70px;'></div>,<div texCode='\\geq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-18px -70px;'></div>,<div texCode='\\prec ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-36px -70px;'></div>,<div texCode='\\succ ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-54px -70px;'></div>,<div texCode='\\preceq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-72px -70px;'></div>,<div texCode='\\succeq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-90px -70px;'></div>,<div texCode='\\ll ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-108px -70px;'></div>,<div texCode='\\gg ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-126px -70px;'></div>,<div texCode='\\equiv ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-144px -70px;'></div>,<div texCode='\\sim ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-162px -70px;'></div>,<div texCode='\\simeq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-180px -70px;'></div>,<div texCode='\\asymp ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-198px -70px;'></div>,<div texCode='\\approx ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-216px -70px;'></div>,<div texCode='\\ne ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-234px -70px;'></div>,<div texCode='\\subset ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-252px -70px;'></div>,<div texCode='\\supset ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-270px -70px;'></div>,<div texCode='\\subseteq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-288px -70px;'></div>,<div texCode='\\supseteq ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-306px -70px;'></div>,<div texCode='\\in ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-324px -70px;'></div>,<div texCode='\\ni ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-342px -70px;'></div>,<div texCode='\\notin ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-360px -70px;'></div>") },
    { name: "rwfh", title: "函数符号", content: toArray("<div texCode='x_{a} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:0px -90px;'></div>,<div texCode='x^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-30px -90px;'></div>,<div texCode='x_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-60px -90px;'></div>,<div texCode='\\bar{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-90px -90px;'></div>,<div texCode='\\tilde{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-120px -90px;'></div>,<div texCode='\\frac{a}{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-150px -90px;'></div>,<div texCode='\\sqrt{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-180px -90px;'></div>,<div texCode='\\sqrt[n]{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-210px -90px;'></div>,<div texCode='\\bigcap_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-240px -90px;'></div>,<div texCode='\\bigcup_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-270px -90px;'></div>,<div texCode='\\prod_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-300px -90px;'></div>,<div texCode='\\coprod_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-330px -90px;'></div>,<div texCode='\\left( x \\right) ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-360px -90px;'></div>,<div texCode='\\left[ x \\right] ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-390px -90px;'></div>,<div texCode='\\left \\{ x \\right \\} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-420px -90px;'></div>,<div texCode='\\left| x \\right| ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-450px -90px;'></div>,<div texCode='\\int_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-480px -90px;'></div>,<div texCode='\\oint_{a}^{b} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-510px -90px;'></div>,<div texCode='\\sum_{a}^{b}{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-540px -90px;'></div>,<div texCode='\\lim_{a \\rightarrow b}{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-570px -90px;'></div>,<div texCode='\\sin ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-600px -90px;'></div>,<div texCode='\\cos ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-628px -90px;'></div>,<div texCode='\\tan ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-655px -90px;'></div>,<div texCode='\\cot ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-685px -90px;'></div>,<div texCode='\\log_{x} ' class='ee-menu-palette-item' style='width: 30px; height: 56px; background-position:-713px -90px;'></div>") },
    { name: "xlzm", title: "特殊箭头", content: toArray("<div texCode='\\leftarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:0px -150px;'></div>,<div texCode='\\rightarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-18px -150px;'></div>,<div texCode='\\leftrightarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-36px -150px;'></div>,<div texCode='\\Leftarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-54px -150px;'></div>,<div texCode='\\Rightarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-72px -150px;'></div>,<div texCode='\\Leftrightarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-90px -150px;'></div>,<div texCode='\\uparrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-108px -150px;'></div>,<div texCode='\\downarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-126px -150px;'></div>,<div texCode='\\updownarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-144px -150px;'></div>,<div texCode='\\Uparrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-162px -150px;'></div>,<div texCode='\\Downarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-180px -150px;'></div>,<div texCode='\\Updownarrow ' class='ee-menu-palette-item' style='width: 18px; height: 18px; background-position:-198px -150px;'></div>") },
];
(function createTab(content) {
    for (var i = 0, ci; ci = content[i++];) {
        var span = document.createElement("span");
        span.setAttribute("tabSrc", ci.name);
        span.innerHTML = ci.title;
        if (i == 1)span.className = "focus";
        domUtils.on(span, "click", function () {
            var tmps = $G("tabHeads").children;
            for (var k = 0, sk; sk = tmps[k++];) {
                sk.className = "";
            }
            tmps = $G("tabBodys").children;
            for (var k = 0, sk; sk = tmps[k++];) {
                sk.style.display = "none";
            }
            this.className = "focus";
            $G(this.getAttribute("tabSrc")).style.display = "";
        });
        $G("tabHeads").appendChild(span);
        domUtils.insertAfter(span, document.createTextNode("\n"));
        var div = document.createElement("div");
        div.id = ci.name;
        div.style.display = (i == 1) ? "" : "none";
        var cons = ci.content;
        for (var j = 0, con; con = cons[j++];) {
            var charSpan = document.createElement("span");
            charSpan.innerHTML = con;
            var charPalette = charSpan.childNodes[0];
            domUtils.on(charPalette, "click", function () {
                //$("#codeText").val($(this).find("div").attr("texCode"));
                insertAtCursor($("#codeText")[0], $(this).attr("texCode"));
                $("#codeImg").html('<img id="equationview" name="equationview" src="http://latex.codecogs.com/gif.latex?' + $("#codeText").val() + '">');
            });
            div.appendChild(charSpan);
        }
        $G("tabBodys").appendChild(div);

        $("#codeText")[0].onpropertychange = $("#codeText")[0].oninput = function () {
            $("#codeImg").html('<img id="equationview" name="equationview" src="http://latex.codecogs.com/gif.latex?' + $("#codeText").val() + '">');
        };

        dialog.onok = function () {
            editor.execCommand("insertHTML", $("#codeImg").html());
            dialog.close();
        }
    }
})(charsContent);
function toArray(str) {
    return str.split(",");
}
function insertAtCursor(myField, myValue) {
    if (document.selection) {
        myField.focus();
        sel = document.selection.createRange();
        sel.text = myValue;
        sel.select();
    }
    else if (myField.selectionStart || myField.selectionStart == '0') {
        var startPos = myField.selectionStart;
        var endPos = myField.selectionEnd;
        var restoreTop = myField.scrollTop;
        myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);
        if (restoreTop > 0) {
            myField.scrollTop = restoreTop;
        }
        myField.focus();
        myField.selectionStart = startPos + myValue.length;
        myField.selectionEnd = startPos + myValue.length;
    } else {
        myField.value += myValue;
        myField.focus();
    }
}
